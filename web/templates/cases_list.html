{% extends "base.html" %}
{% load i18n static %}
{% get_current_language as LANGUAGE_CODE %}

{% block title %}Datalization – {% trans "Case Studies" %}{% endblock %}

{% block content %}
<div class="min-h-screen bg-background text-foreground">

  <!-- Hero: Titel + Unterzeile -->
  <section class="scroll-mt-20">
      <div class="case-hero">
        <div class="container max-w-3xl mx-auto text-center">
          <h1 class="case-hero-title">Case Studies</h1>
          <p class="text-muted max-w-2xl mx-auto">
            {% if LANGUAGE_CODE == 'de' %}
              Erfolgsgeschichten unserer Kunden – von der Herausforderung zur Lösung
            {% else %}
              Success stories of our clients – from challenge to solution
            {% endif %}
          </p>
        </div>
      </div>

      <!-- Grid mit Case Cards -->
      <div class="case-list max-w-7xl mx-auto">
        {% for c in cases %}
          <div class="case-row-outer {% cycle 'layout-left' 'layout-right' %}">
            {% if forloop.counter|divisibleby:2 %}
              <!-- EVEN (Case right, Icon left) -->
              <div class="case-icon-col">
                {% with idx=forloop.counter|stringformat:"s" %}
                  {% include "icons/decorative-"|add:idx|add:".html" %}
                {% endwith %}
              </div>
              <div class="case-card-col">
                <article class="case-card fade-in-on-scroll">

                  <!-- Bild + Kategorie-Badge -->
                  <div class="case-image">
                    {% if c.image %}
                      <img
                        src="{{ c.image.url }}"
                        alt="{{ c.title }}"
                        class="case-img"
                        loading="lazy"
                        decoding="async"
                      >
                    {% else %}
                      <div class="case-img case-img--placeholder">D</div>
                    {% endif %}

                    {% if c.category %}
                      <div class="case-badge">
                        <span class="badge-primary">{{ c.category }}</span>
                      </div>
                    {% endif %}
                  </div>

                  <!-- Inhalt -->
                  <div class="p-6">
                    <h2 class="mb-3">
                      <a href="{% url 'web:case_detail' slug=c.slug %}">
                        {{ c.title }}
                      </a>
                    </h2>

                    <p class="text-muted mb-6">
                      {% if c.summary %}
                        {{ c.summary|truncatechars:200 }}
                      {% elif c.problem_brief %}
                        {{ c.problem_brief|truncatechars:200 }}
                      {% else %}
                        {% if LANGUAGE_CODE == 'de' %}
                          Ausgewähltes Kundenprojekt mit messbaren Ergebnissen.
                        {% else %}
                          Selected client project with measurable results.
                        {% endif %}
                      {% endif %}
                    </p>

                    <!-- Client / Problem / Result – Figma-Style Rows -->
                    <div class="case-rows">

                      <!-- Client -->
                      <div class="case-row case-row--client">
                        <div class="case-row-icon-wrap"></div>
                        <div>
                          <div class="case-row-label">
                            {% trans "Client" %}
                          </div>
                          <p class="text-muted case-row-text">
                            {{ c.client_brief|default:"–" }}
                          </p>
                        </div>
                      </div>

                      <!-- Problem -->
                      <div class="case-row case-row--problem">
                        <div class="case-row-icon-wrap"></div>
                        <div>
                          <div class="case-row-label">
                            {% trans "Problem" %}
                          </div>
                          <p class="text-muted case-row-text">
                            {{ c.problem_brief|default:"–" }}
                          </p>
                        </div>
                      </div>

                      <!-- Result -->
                      <div class="case-row case-row--result">
                        <div class="case-row-icon-wrap"></div>
                        <div>
                          <div class="case-row-label">
                            {% trans "Result" %}
                          </div>
                          {% if c.result_list %}
                            <ul class="text-muted" style="margin:0; padding-left:1.1rem;">
                              {% for item in c.result_list %}
                                <li>{{ item }}</li>
                              {% endfor %}
                            </ul>
                          {% else %}
                            <p class="text-muted case-row-text">–</p>
                          {% endif %}
                        </div>
                      </div>
                    </div>

                    <!-- CTA -->
                    <a class="view-more-btn" href="{% url 'web:case_detail' slug=c.slug %}">
                      {% if LANGUAGE_CODE == 'de' %}Details ansehen{% else %}View details{% endif %}
                      <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="7" y1="17" x2="17" y2="7"></line>
                        <polyline points="7 7 17 7 17 17"></polyline>
                      </svg>
                    </a>
                  </div>
                </article>
              </div>
            {% else %}
              <!-- ODD (Case left, Icon right) -->
              <div class="case-card-col">
                <article class="case-card fade-in-on-scroll">

                  <!-- Bild + Kategorie-Badge -->
                  <div class="case-image">
                    {% if c.image %}
                      <img
                        src="{{ c.image.url }}"
                        alt="{{ c.title }}"
                        class="case-img"
                        loading="lazy"
                        decoding="async"
                      >
                    {% else %}
                      <div class="case-img case-img--placeholder">D</div>
                    {% endif %}

                    {% if c.category %}
                      <div class="case-badge">
                        <span class="badge-primary">{{ c.category }}</span>
                      </div>
                    {% endif %}
                  </div>

                  <!-- Inhalt -->
                  <div class="p-6">
                    <h2 class="mb-3">
                      <a href="{% url 'web:case_detail' slug=c.slug %}">
                        {{ c.title }}
                      </a>
                    </h2>

                    <p class="text-muted mb-6">
                      {% if c.summary %}
                        {{ c.summary|truncatechars:200 }}
                      {% elif c.problem_brief %}
                        {{ c.problem_brief|truncatechars:200 }}
                      {% else %}
                        {% if LANGUAGE_CODE == 'de' %}
                          Ausgewähltes Kundenprojekt mit messbaren Ergebnissen.
                        {% else %}
                          Selected client project with measurable results.
                        {% endif %}
                      {% endif %}
                    </p>

                    <!-- Client / Problem / Result – Figma-Style Rows -->
                    <div class="case-rows">

                      <!-- Client -->
                      <div class="case-row case-row--client">
                        <div class="case-row-icon-wrap"></div>
                        <div>
                          <div class="case-row-label">
                            {% trans "Client" %}
                          </div>
                          <p class="text-muted case-row-text">
                            {{ c.client_brief|default:"–" }}
                          </p>
                        </div>
                      </div>

                      <!-- Problem -->
                      <div class="case-row case-row--problem">
                        <div class="case-row-icon-wrap"></div>
                        <div>
                          <div class="case-row-label">
                            {% trans "Problem" %}
                          </div>
                          <p class="text-muted case-row-text">
                            {{ c.problem_brief|default:"–" }}
                          </p>
                        </div>
                      </div>

                      <!-- Result -->
                      <div class="case-row case-row--result">
                        <div class="case-row-icon-wrap"></div>
                        <div>
                          <div class="case-row-label">
                            {% trans "Result" %}
                          </div>
                          {% if c.result_list %}
                            <ul class="text-muted" style="margin:0; padding-left:1.1rem;">
                              {% for item in c.result_list %}
                                <li>{{ item }}</li>
                              {% endfor %}
                            </ul>
                          {% else %}
                            <p class="text-muted case-row-text">–</p>
                          {% endif %}
                        </div>
                      </div>
                    </div>

                    <!-- CTA -->
                    <a class="view-more-btn" href="{% url 'web:case_detail' slug=c.slug %}">
                      {% if LANGUAGE_CODE == 'de' %}Details ansehen{% else %}View details{% endif %}
                      <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="7" y1="17" x2="17" y2="7"></line>
                        <polyline points="7 7 17 7 17 17"></polyline>
                      </svg>
                    </a>
                  </div>
                </article>
              </div>
              <div class="case-icon-col">
                {% with idx=forloop.counter|stringformat:"s" %}
                  {% include "icons/decorative-"|add:idx|add:".html" %}
                {% endwith %}
              </div>
            {% endif %}
          </div>
        {% empty %}
          <p class="text-muted text-center py-10">
            {% if LANGUAGE_CODE == 'de' %}
              Noch keine Case Studies veröffentlicht.
            {% else %}
              No case studies published yet.
            {% endif %}
          </p>
        {% endfor %}
      </div>
    </div>
  </section>
  <section class="case-cta-wrap">
  <div class="container case-cta-inner">
    <h2 class="case-cta-title">
      {% if LANGUAGE_CODE == 'de' %}
        Ihr Projekt könnte das nächste sein
      {% else %}
        Your project could be the next one
      {% endif %}
    </h2>
    <p class="case-cta-text">
      {% if LANGUAGE_CODE == 'de' %}
        Lassen Sie uns gemeinsam Ihre Erfolgsgeschichte schreiben.
      {% else %}
        Let’s write your next success story together.
      {% endif %}
    </p>
    <a href="/#contact" class="case-cta-btn">
      {% if LANGUAGE_CODE == 'de' %}Projekt starten{% else %}Start a project{% endif %}
      <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="7" y1="17" x2="17" y2="7"></line>
        <polyline points="7 7 17 7 17 17"></polyline>
      </svg>
    </a>
  </div>
</section>
</div>
{% endblock %}

{% block extra_scripts %}
  <script src="{% static 'js/case-icons.js' %}"></script>
{% endblock %}